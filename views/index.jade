doctype html
html
  head
    title Padnews
    style.
      body {
        font-family: "Fira Sans OT", "XinGothic-Citicpress", "XinGothic Citicpress", "Lantinghei TC", "Hiragino Kaku Gothic Pro", "Apple LiGothic", "Heiti TC", "LiHei Pro", "Microsoft YaHei", "微軟正黑體", "文泉驿正黑", sans-serif;
        background: #16161D;
      }
      .time, .location {
        font-weight: bold;
      }
      .time {
        color: #f60;
        margin-right: 0.5em;
      }
      .location {
        color: #f90;
      }
      .content {
        color: white;
      }
  body
    - for(i=news.length-1; entry=news[i]; --i)
      section.entry
        span.time #{entry.time}
        span.location [#{entry.location}]
        - for(j=entry.content.length-1; p=entry.content[j]; --j)
          p.content #{p}
    script(src="//code.jquery.com/jquery-2.1.0.min.js")
    script(src="/socket.io/socket.io.js")
    script.
      var socket = io.connect('/');
      socket.on('msg', function(data) {
        console.log(data);
      });
      socket.on('patch', function(data) {
        var $sec, j, i;

        $sec = $('<section class="entry"><span class="time">' + data.value.time + '</span><span class="location">[' + data.value.location + ']</span></section>')
        for(j in data.value.content)
          $sec.append('<p class="content">' + data.value.content[j] + '</p>')

        i = +data.path.substr(1);

        switch(data.op) {
          case 'add':
            $('body').prepend($sec);
            break;
          case 'replace':
            $('.entry').eq(-i-1).replaceWith($sec);
            break;
        }
      });
